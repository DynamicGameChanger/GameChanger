<!DOCTYPE html>
<html>


<head>
  <meta charset="utf-8">
  <title>Game Controller</title>
  <script src='/socket.io/socket.io.js'></script>
  <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
  <link rel="stylesheet" href="controller/css/style.css">
  <link href="controller/css/graph.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <div class='module' id='dataDisplay' >
    <div id="graph">

    </div>
    <div id='graphOptions'>
    </div>
  </div>
  <div class='module' id='screenCast'>
  </div>
  <div class='module' id='controls'>

    <h1>hello controller</h1>
    <p> Give the player this URL!!!
      <p id='url'></p>
    </p>

  </div>
  <div class='module' id='otherBox'>
    <h1>Space holder for some other stuff</h1>
  </div>


  <script src='/socket.io/socket.io.js'></script>
  <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
  <script>
    // var qs = '/hi' //'/' + window.location.search.slice(window.location.search.indexOf('?') + 4);
    var url = 'localhost:3000/snake?id=' + window.location.search.slice(window.location.search.indexOf('?') + 4);
    $('#url').text(url);

    var socket = io();
    var ctrlObj = {
      speed: {
        type: 'range',
        min: 50,
        max: 500,
        step: 10,
        value: 250
      },
      sizeScale: {
        type: 'range',
        min: 0.25,
        max: 1,
        step: 0.05,
        value: 0.5
      },
      gridSize: {
        type: 'range',
        min: 100,
        max: 1000,
        step: 100,
        value: 500
      },
      addApple: {
        type: 'button'
      }
    }
// <<<<<<< HEAD
//
//     for (var key in ctrlObj) {
//       if (ctrlObj[key].type === 'range') {
//         $('#controls').append('<input type="range" id="' + key + '" min="' + ctrlObj[key].min + ' "max="' + ctrlObj[key].max + '" step="' + ctrlObj[key].step + '"  value="' + ctrlObj[key].value + '" />');
//         $("'#" + key + "'").on('input', function(e) {
//           var value = e.target.value;
//           localStorage.setItem("'" + key + "'", e);
//           socket.emit("'" + key + "'", value);
//         })
//       if (ctrlObj[key].type === 'button') $('#controls').append('<button id="' + key + '"></button>');
//     }
//     socket.emit('obj', ctrlObj);
// =======
    socket.emit('obj', ctrlObj);
        for (var key in ctrlObj) {
          if(ctrlObj[key].value || ctrlObj[key].value === 0)
            localStorage.setItem(ctrlObj[key], ctrlObj[key].value)
          if (ctrlObj[key].type === 'range') $('#controls').append('<p>' + key + '</p><input type="range" id="' + key + '" min="' + ctrlObj[key].min + ' "max="' + ctrlObj[key].max + '" step="' + ctrlObj[key].step + '"  value="' + ctrlObj[key].value + '" />');
          if (ctrlObj[key].type === 'button') $('#controls').append('<br><br><input type="submit" id="' + key + '" value="' + key + '"></input>');
        }

    // $('#speed').on('input', function(e) {
    //   var value = e.target.value;
    //   localStorage.setItem('speed', e);
    //   socket.emit('changeVariable', value);
    // })

    $('input').on('input', function(e) {
      // console.log('emitted:' + qs);
      console.log(e.target.value)
      localStorage.setItem(e.target.id, e.target.value)
      socket.emit('changeVariable', [e.target.id, e.target.value])
    })

    socket.on('image', url => {
      $('#screenCast').empty();
      var img = new Image();
      img.id = 'screenShare';
      img.src = url;
      // img.width = 300;
      $('#screenCast').get(0).appendChild(img);
    })

  </script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="controller/graph.js" charset="utf-8"></script>
  </body>
</html>
