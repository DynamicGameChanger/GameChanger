<!DOCTYPE html>
<html>


<head>
  <meta charset="utf-8">
  <title>Game Controller</title>
  <script src='/socket.io/socket.io.js'></script>
  <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>

  <link rel="stylesheet" href="controller/css/style.css">
  <link href="controller/css/graph.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <div class='module' id='dataDisplay'>
    <div id="graph">

    </div>
    <div id='graphOptions'>
    </div>
  </div>
  <div class='module' id='screenCast'>
  </div>
  <div class='module' id='controls'>

    <h1 id='greeting'>Hello UserName</h1>
    <p id="player"> Give playerName this URL:
      <p id='url'></p>
    </p>
    <table id='controllers'>
      <tr width='100%'>
      </tr>
    </table>
  </div>
  <div class='module' id='otherBox'>
    <!-- <input type='text' value="75" class="dial" data-width="70" data-thickness='0.2' /> -->
  </div>


  <script src='/socket.io/socket.io.js'></script>
  <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
  <script>
    var qs = '/hi' //'/' + window.location.search.slice(window.location.search.indexOf('?') + 4);
    var url = 'localhost:3000/snake?id=' + window.location.search.slice(window.location.search.indexOf('?') + 4);
    $('#url').text(url);
    // var socket = io(qs);
    var socket = io();
    $('#variable1').on('input', function(e) {
      var value = e.target.value;

      socket.emit('changeVariable', value)
      console.log('emitted:' + qs);
    })
    var obj = {
        scale: localStorage.getItem('scale') || 1,
        sizeScale: localStorage.getItem('sizeScale') || 1,
        gridSize: localStorage.getItem('gridSize') || 1000,
        speed: localStorage.getItem('speed') || 250
      }
      // var socket = io();
      //   $('#variable1').on('input', function(e){
      //     var value = e.target.value;

    var ctrlObj = {
      speed: {
        type: 'range',
        min: 0,
        max: 500,
        step: 10,
        value: 250
      },
      sizeScale: {
        type: 'range',
        min: 0.25,
        max: 1,
        step: 0.05,
        value: 1
      },
      gridSize: {
        type: 'range',
        min: 100,
        max: 1000,
        step: 100,
        value: 500
      },
      addApple: {
        type: 'button'
      }
    }
    var numOfVars = Object.keys(ctrlObj).length;
    for (var key in ctrlObj) {
      if (ctrlObj[key].type === 'range') {
        $('#controllers tr').append('<td width="'+100/numOfVars+'%"><h3>' + key + '</h3><input type="text" value="' + ctrlObj[key].value + '" class="dial" id="' + key + '" data-step="'+ctrlObj[key].step+'" data-min="' + ctrlObj[key].min + '" data-max="' + ctrlObj[key].max +
          '" data-width="100" data-thickness="0.4" padding="20px"/></td>');
      }
      // if (ctrlObj[key].type === 'button') $('#controls').append('<button id="' + key + '"></button>');
    }

    $(document).ready(function($) {
      $(".dial").knob();
    });

    var obj = {
      scale: localStorage.getItem('scale') || 1,
      sizeScale: localStorage.getItem('sizeScale') || 1,
      gridSize: localStorage.getItem('gridSize') || 1000,
      speed: localStorage.getItem('speed') || 250
    }
    $('body').on('click', function() { // console.log(obj)
      socket.emit('obj', obj);
    });
    socket.on('image', url => {
          $('#screenCast').empty();
          var img = new Image();
          img.id = 'screenShare';
          img.src = url;
          img.width = 300;
          $('#screenCast').get(0).appendChild(img); })
  </script>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="controller/src/graph.js" charset="utf-8"></script>
  <script src='controller/src/jquery.knob.js' charset="utf-8"></script>
</body>


</html>
